<div class="admin-header">
    <h1>ìš´ë™ ê´€ë¦¬</h1>
    <button class="btn btn-primary" onclick="document.getElementById('addModal').style.display='flex'">
        + ìš´ë™ ì¶”ê°€
    </button>
</div>

<div class="admin-card">
    <% if (exercises.length === 0) { %>
        <div class="empty-state">
            <div class="empty-state-icon">ğŸ‹ï¸</div>
            <div class="empty-state-title">ë“±ë¡ëœ ìš´ë™ì´ ì—†ìŠµë‹ˆë‹¤</div>
            <p>ìƒˆë¡œìš´ ìš´ë™ì„ ì¶”ê°€í•´ë³´ì„¸ìš”.</p>
        </div>
    <% } else { %>
        <table class="admin-table">
            <thead>
                <tr>
                    <th>ì½”ë“œ</th>
                    <th>ì´ë¦„</th>
                    <th>ì„¤ëª…</th>
                    <th>ìƒíƒœ</th>
                    <th>ê´€ë¦¬</th>
                </tr>
            </thead>
            <tbody>
                <% exercises.forEach(exercise => { %>
                    <tr>
                        <td><code><%= exercise.code %></code></td>
                        <td><strong><%= exercise.name %></strong></td>
                        <td><%= exercise.description || '-' %></td>
                        <td>
                            <% if (exercise.is_active) { %>
                                <span class="badge badge-success">í™œì„±</span>
                            <% } else { %>
                                <span class="badge badge-danger">ë¹„í™œì„±</span>
                            <% } %>
                        </td>
                        <td>
                            <div class="action-btns">
                                <button class="btn btn-sm btn-secondary" onclick="openEditModal('<%= exercise.exercise_id %>', '<%= exercise.code %>', '<%= exercise.name %>', '<%= exercise.description || '' %>', <%= exercise.is_active %>)">
                                    ìˆ˜ì •
                                </button>
                                <form action="/admin/exercises/<%= exercise.exercise_id %>/delete" method="POST" style="display:inline;" onsubmit="return confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?');">
                                    <button type="submit" class="btn btn-sm btn-danger">ì‚­ì œ</button>
                                </form>
                            </div>
                        </td>
                    </tr>
                <% }) %>
            </tbody>
        </table>
    <% } %>
</div>

<!-- ì¶”ê°€ ëª¨ë‹¬ -->
<div id="addModal" class="modal-overlay" style="display: none;">
    <div class="modal">
        <div class="modal-header">
            <h3 class="modal-title">ìš´ë™ ì¶”ê°€</h3>
            <button class="modal-close" onclick="document.getElementById('addModal').style.display='none'">&times;</button>
        </div>
        <form action="/admin/exercises" method="POST">
            <div class="form-group">
                <label class="form-label">ì½”ë“œ *</label>
                <input type="text" name="code" class="form-input" placeholder="PUSH_UP" required pattern="[A-Z0-9_]+" />
                <div class="form-hint">ì˜ë¬¸ ëŒ€ë¬¸ì, ìˆ«ì, ë°‘ì¤„ë§Œ ì‚¬ìš© (ì˜ˆ: PUSH_UP, SQUAT)</div>
            </div>
            <div class="form-group">
                <label class="form-label">ì´ë¦„ *</label>
                <input type="text" name="name" class="form-input" placeholder="í‘¸ì‹œì—…" required />
            </div>
            <div class="form-group">
                <label class="form-label">ì„¤ëª…</label>
                <textarea name="description" class="form-textarea" placeholder="ìš´ë™ì— ëŒ€í•œ ì„¤ëª…..."></textarea>
            </div>
            <div class="form-group">
                <label class="toggle">
                    <input type="checkbox" name="is_active" checked />
                    <span class="toggle-slider"></span>
                </label>
                <span style="margin-left: 12px;">í™œì„±í™”</span>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="document.getElementById('addModal').style.display='none'">ì·¨ì†Œ</button>
                <button type="submit" class="btn btn-primary">ì¶”ê°€</button>
            </div>
        </form>
    </div>
</div>

<!-- ìˆ˜ì • ëª¨ë‹¬ -->
<div id="editModal" class="modal-overlay" style="display: none;">
    <div class="modal">
        <div class="modal-header">
            <h3 class="modal-title">ìš´ë™ ìˆ˜ì •</h3>
            <button class="modal-close" onclick="document.getElementById('editModal').style.display='none'">&times;</button>
        </div>
        <form id="editForm" method="POST">
            <div class="form-group">
                <label class="form-label">ì½”ë“œ *</label>
                <input type="text" name="code" id="edit_code" class="form-input" required pattern="[A-Z0-9_]+" />
            </div>
            <div class="form-group">
                <label class="form-label">ì´ë¦„ *</label>
                <input type="text" name="name" id="edit_name" class="form-input" required />
            </div>
            <div class="form-group">
                <label class="form-label">ì„¤ëª…</label>
                <textarea name="description" id="edit_description" class="form-textarea"></textarea>
            </div>
            <div class="form-group">
                <label class="toggle">
                    <input type="checkbox" name="is_active" id="edit_is_active" />
                    <span class="toggle-slider"></span>
                </label>
                <span style="margin-left: 12px;">í™œì„±í™”</span>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="document.getElementById('editModal').style.display='none'">ì·¨ì†Œ</button>
                <button type="submit" class="btn btn-primary">ì €ì¥</button>
            </div>
        </form>
    </div>
</div>

<script>
function openEditModal(id, code, name, description, isActive) {
    document.getElementById('editForm').action = '/admin/exercises/' + id;
    document.getElementById('edit_code').value = code;
    document.getElementById('edit_name').value = name;
    document.getElementById('edit_description').value = description;
    document.getElementById('edit_is_active').checked = isActive;
    document.getElementById('editModal').style.display = 'flex';
}
</script>
